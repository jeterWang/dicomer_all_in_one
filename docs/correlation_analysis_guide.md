# ç›¸å…³æ€§åˆ†æžæ¨¡å—ä½¿ç”¨æŒ‡å—

## ðŸ“‹ æ¦‚è¿°

ç›¸å…³æ€§åˆ†æžæ¨¡å—æ˜¯DICOM All-in-Oneå·¥å…·ä¸­çš„æ ¸å¿ƒåŠŸèƒ½ä¹‹ä¸€ï¼Œä¸“é—¨ç”¨äºŽåˆ†æžåŒ»å­¦å½±åƒä¹‹é—´çš„ç›¸å…³æ€§ã€‚è¯¥æ¨¡å—æ”¯æŒå¤šç§è¾“å…¥æ ¼å¼ï¼Œæä¾›ä¸°å¯Œçš„è‡ªå®šä¹‰é€‰é¡¹ï¼Œå¹¶ç”Ÿæˆä¸“ä¸šçš„åˆ†æžæŠ¥å‘Šã€‚

## ðŸŽ¯ ä¸»è¦åŠŸèƒ½

### æ”¯æŒçš„æ–‡ä»¶æ ¼å¼
- **NIfTIæ–‡ä»¶** (.nii, .nii.gz) - æŽ¨èç”¨äºŽDRMåˆ†æž
- **DICOM PETå›¾åƒ** - æ”¯æŒç›®å½•æ‰¹é‡åŠ è½½
- **RTSSæ–‡ä»¶** - ç”¨äºŽå®šä¹‰æ„Ÿå…´è¶£åŒºåŸŸ(ROI)

### åˆ†æžç±»åž‹
1. **NIfTIç›¸å…³æ€§åˆ†æž** - ç›´æŽ¥æ¯”è¾ƒä¸¤ä¸ªNIfTIæ–‡ä»¶
2. **DICOM ROIç›¸å…³æ€§åˆ†æž** - åŸºäºŽRTSSå®šä¹‰çš„ROIåŒºåŸŸåˆ†æž

## ðŸš€ å¿«é€Ÿå¼€å§‹

### æ–¹æ³•1: GUIç•Œé¢æ“ä½œ

#### NIfTIæ–‡ä»¶åˆ†æž
1. å¯åŠ¨åº”ç”¨ç¨‹åºï¼š`uv run python main.py`
2. åˆ‡æ¢åˆ° **"NIfTIç›¸å…³æ€§åˆ†æž"** æ ‡ç­¾é¡µ
3. æŒ‰ç…§ä»¥ä¸‹æ­¥éª¤æ“ä½œï¼š

**æ­¥éª¤1: åŠ è½½æ–‡ä»¶**
- ç‚¹å‡»"é€‰æ‹©ç¬¬ä¸€ä¸ªNIfTIæ–‡ä»¶"ï¼Œé€‰æ‹© `data/drm_data/DRM.nii.gz`
- ç‚¹å‡»"é€‰æ‹©ç¬¬äºŒä¸ªNIfTIæ–‡ä»¶"ï¼Œé€‰æ‹© `data/drm_data/targetDRM.nii.gz`

**æ­¥éª¤2: é€‰æ‹©åˆ†æžé€‰é¡¹**
- æŽ©ç é€‰é¡¹ï¼šæŽ¨èé€‰æ‹©"ä¸¤ä¸ªå›¾åƒéƒ½éžé›¶çš„åƒç´ "ï¼ˆèŽ·å¾—æœ€é«˜ç›¸å…³æ€§ï¼‰
- é˜ˆå€¼ï¼šé»˜è®¤0.1ï¼ˆä»…åœ¨é€‰æ‹©é˜ˆå€¼æŽ©ç æ—¶ä½¿ç”¨ï¼‰

**æ­¥éª¤3: è‡ªå®šä¹‰é€‰é¡¹**
- å›¾è¡¨æ ‡é¢˜ï¼šä¾‹å¦‚ "DRM vs Target DRM ç›¸å…³æ€§åˆ†æž"
- Xè½´æ ‡ç­¾ï¼šä¾‹å¦‚ "DRM åƒç´ å€¼"
- Yè½´æ ‡ç­¾ï¼šä¾‹å¦‚ "Target DRM åƒç´ å€¼"
- è¾“å‡ºæ–‡ä»¶å‰ç¼€ï¼šä¾‹å¦‚ "DRM_analysis"

**æ­¥éª¤4: æ‰§è¡Œåˆ†æž**
- é€‰æ‹©è¾“å‡ºç›®å½•ï¼ˆæˆ–ä½¿ç”¨é»˜è®¤ç›®å½•ï¼‰
- ç‚¹å‡»"åˆ†æžNIfTIç›¸å…³æ€§"æŒ‰é’®

#### DICOM PETåˆ†æž
1. åˆ‡æ¢åˆ° **"ç›¸å…³æ€§åˆ†æž"** æ ‡ç­¾é¡µ
2. åŠ è½½ä¸¤ä¸ªPETå›¾åƒç›®å½•å’ŒRTSSæ–‡ä»¶
3. é€‰æ‹©ROIå’Œè‡ªå®šä¹‰é€‰é¡¹
4. æ‰§è¡Œåˆ†æž

### æ–¹æ³•2: å‘½ä»¤è¡Œè„šæœ¬

```bash
# å®Œæ•´æµ‹è¯•ï¼ˆåŒ…å«4ç§æŽ©ç é€‰é¡¹ï¼‰
uv run python test_nifti_correlation.py

# å¿«é€Ÿæµ‹è¯•ï¼ˆä»…æœ€ä½³é€‰é¡¹ï¼‰
uv run python quick_nifti_test.py

# è‡ªå®šä¹‰é€‰é¡¹æµ‹è¯•
uv run python test_custom_nifti_analysis.py
```

## ðŸ“Š åˆ†æžç»“æžœè§£è¯»

### ç›¸å…³ç³»æ•°å«ä¹‰
- **Pearsonç›¸å…³ç³»æ•° (r)**ï¼šè¡¡é‡çº¿æ€§ç›¸å…³æ€§
  - r > 0.7ï¼šå¼ºæ­£ç›¸å…³
  - 0.3 < r < 0.7ï¼šä¸­ç­‰æ­£ç›¸å…³
  - r < 0.3ï¼šå¼±ç›¸å…³
- **Spearmanç›¸å…³ç³»æ•° (Ï)**ï¼šè¡¡é‡å•è°ƒç›¸å…³æ€§
- **på€¼**ï¼šç»Ÿè®¡æ˜¾è‘—æ€§ï¼Œp < 0.05è¡¨ç¤ºæ˜¾è‘—ç›¸å…³

### DRM vs targetDRM åˆ†æžç»“æžœ
æ ¹æ®æµ‹è¯•ç»“æžœï¼Œä¸¤ä¸ªDRMæ–‡ä»¶çš„ç›¸å…³æ€§åˆ†æžæ˜¾ç¤ºï¼š

| æŽ©ç é€‰é¡¹ | Pearson r | Spearman r | åƒç´ æ•° | æŽ¨èåº¦ |
|---------|-----------|------------|--------|--------|
| ä¸¤ä¸ªå›¾åƒéƒ½éžé›¶çš„åƒç´  | **0.6136** | **0.5889** | 312 | â­â­â­â­â­ |
| ç¬¬ä¸€ä¸ªå›¾åƒçš„æ‰€æœ‰éžé›¶åƒç´  | -0.0107 | -0.0950 | 486 | â­ |
| ç¬¬ä¸€ä¸ªå›¾åƒçš„æ‰€æœ‰æ­£å€¼åƒç´  | -0.0107 | -0.0950 | 486 | â­ |
| ç¬¬ä¸€ä¸ªå›¾åƒè¶…è¿‡é˜ˆå€¼çš„åƒç´  | -0.0149 | -0.0960 | 468 | â­ |

**ç»“è®º**: ä½¿ç”¨"ä¸¤ä¸ªå›¾åƒéƒ½éžé›¶çš„åƒç´ "æŽ©ç èŽ·å¾—æœ€ä½³ç»“æžœï¼Œæ˜¾ç¤º**ä¸­ç­‰åå¼ºçš„æ­£ç›¸å…³å…³ç³»**ã€‚

## ðŸ“ è¾“å‡ºæ–‡ä»¶

æ¯æ¬¡åˆ†æžç”Ÿæˆä»¥ä¸‹æ–‡ä»¶ï¼š

### CSVæ•°æ®æ–‡ä»¶
- **æ–‡ä»¶åæ ¼å¼**: `{å‰ç¼€}_{æŽ©ç ç±»åž‹}_{æ—¶é—´æˆ³}.csv`
- **å†…å®¹**: åŒ…å«æ‰€æœ‰åƒç´ å€¼å¯¹ï¼Œä¾¿äºŽè¿›ä¸€æ­¥ç»Ÿè®¡åˆ†æž
- **æ ¼å¼**: ä¸¤åˆ—æ•°æ®ï¼ˆImage1, Image2ï¼‰

### æ•£ç‚¹å›¾
- **æ–‡ä»¶åæ ¼å¼**: `{å‰ç¼€}_{æŽ©ç ç±»åž‹}_{æ—¶é—´æˆ³}.png`
- **å†…å®¹**: é«˜åˆ†è¾¨çŽ‡æ•£ç‚¹å›¾ï¼ŒåŒ…å«ï¼š
  - æ•°æ®ç‚¹åˆ†å¸ƒ
  - å›žå½’çº¿
  - ç›¸å…³ç³»æ•°å’Œpå€¼
  - è‡ªå®šä¹‰æ ‡é¢˜å’Œè½´æ ‡ç­¾

### ç¤ºä¾‹è¾“å‡ºæ–‡ä»¶å
```
DRM_analysis_ä¸¤ä¸ªå›¾åƒéƒ½éžé›¶çš„åƒç´ _20250629_205422.csv
DRM_analysis_ä¸¤ä¸ªå›¾åƒéƒ½éžé›¶çš„åƒç´ _20250629_205423.png
```

## âš™ï¸ é«˜çº§åŠŸèƒ½

### è‡ªå®šä¹‰é€‰é¡¹è¯¦è§£

#### å›¾è¡¨æ ‡é¢˜
- ç”¨é€”ï¼šè®¾ç½®æ•£ç‚¹å›¾çš„ä¸»æ ‡é¢˜
- ç¤ºä¾‹ï¼š
  - "DRM vs Target DRM ç›¸å…³æ€§åˆ†æž"
  - "åŒ»å­¦å½±åƒç›¸å…³æ€§åˆ†æž"
  - "Image Correlation Analysis"

#### è½´æ ‡ç­¾
- Xè½´æ ‡ç­¾ï¼šæè¿°ç¬¬ä¸€ä¸ªå›¾åƒ
- Yè½´æ ‡ç­¾ï¼šæè¿°ç¬¬äºŒä¸ªå›¾åƒ
- ç¤ºä¾‹ï¼š
  - "DRM åƒç´ å€¼" / "Target DRM åƒç´ å€¼"
  - "åŽŸå§‹å½±åƒå¼ºåº¦" / "ç›®æ ‡å½±åƒå¼ºåº¦"
  - "Image A" / "Image B"

#### è¾“å‡ºæ–‡ä»¶å‰ç¼€
- ç”¨é€”ï¼šè‡ªå®šä¹‰è¾“å‡ºæ–‡ä»¶çš„å‘½åå‰ç¼€
- ç¤ºä¾‹ï¼š
  - "DRM_analysis"
  - "medical_analysis"
  - "correlation_study"

### æŽ©ç é€‰é¡¹è¯´æ˜Ž

1. **ä¸¤ä¸ªå›¾åƒéƒ½éžé›¶çš„åƒç´ ** â­æŽ¨è
   - åªåˆ†æžä¸¤ä¸ªå›¾åƒä¸­éƒ½æœ‰æœ‰æ•ˆæ•°æ®çš„åŒºåŸŸ
   - é¿å…èƒŒæ™¯å™ªå£°å¹²æ‰°
   - é€šå¸¸èŽ·å¾—æœ€å¯é çš„ç›¸å…³æ€§ç»“æžœ

2. **ç¬¬ä¸€ä¸ªå›¾åƒçš„æ‰€æœ‰éžé›¶åƒç´ **
   - ä»¥ç¬¬ä¸€ä¸ªå›¾åƒä¸ºåŸºå‡†
   - åŒ…å«ç¬¬ä¸€ä¸ªå›¾åƒçš„æ‰€æœ‰æœ‰æ•ˆåŒºåŸŸ

3. **ç¬¬ä¸€ä¸ªå›¾åƒçš„æ‰€æœ‰æ­£å€¼åƒç´ **
   - åªè€ƒè™‘ç¬¬ä¸€ä¸ªå›¾åƒä¸­çš„æ­£å€¼
   - é€‚ç”¨äºŽæŸäº›ç‰¹æ®Šåˆ†æžéœ€æ±‚

4. **ç¬¬ä¸€ä¸ªå›¾åƒè¶…è¿‡é˜ˆå€¼çš„åƒç´ **
   - å¯è°ƒèŠ‚é˜ˆå€¼ï¼ˆé»˜è®¤0.1ï¼‰
   - è¿‡æ»¤ä½Žå¼ºåº¦åŒºåŸŸ

## ðŸ”§ æŠ€æœ¯ç‰¹æ€§

### å›¾åƒå¤„ç†èƒ½åŠ›
- **è‡ªåŠ¨é‡é‡‡æ ·**: å¤„ç†ä¸åŒå°ºå¯¸çš„å›¾åƒ
- **æ•°æ®æ¸…ç†**: è‡ªåŠ¨ç§»é™¤NaNå’Œæ— ç©·å€¼
- **å¤šç§æŽ©ç **: 4ç§åƒç´ é€‰æ‹©ç­–ç•¥

### ç»Ÿè®¡åˆ†æž
- **åŒé‡ç›¸å…³æ€§**: Pearson + Spearman
- **æ˜¾è‘—æ€§æ£€éªŒ**: è‡ªåŠ¨è®¡ç®—på€¼
- **å›žå½’åˆ†æž**: çº¿æ€§æ‹Ÿåˆå’ŒRÂ²å€¼

### è¾“å‡ºè´¨é‡
- **é«˜åˆ†è¾¨çŽ‡å›¾åƒ**: 300 DPIè¾“å‡º
- **ä¸“ä¸šæ ¼å¼**: åŒ…å«å®Œæ•´ç»Ÿè®¡ä¿¡æ¯
- **è‡ªå®šä¹‰æ ·å¼**: æ”¯æŒä¸ªæ€§åŒ–æ ‡é¢˜å’Œæ ‡ç­¾

## ðŸ“ æœ€ä½³å®žè·µ

1. **æ–‡ä»¶å‡†å¤‡**
   - ç¡®ä¿å›¾åƒå·²æ­£ç¡®é…å‡†
   - æ£€æŸ¥å›¾åƒæ–¹å‘å’Œåæ ‡ç³»
   - éªŒè¯æ•°æ®å®Œæ•´æ€§

2. **æŽ©ç é€‰æ‹©**
   - ä¼˜å…ˆä½¿ç”¨"ä¸¤ä¸ªå›¾åƒéƒ½éžé›¶çš„åƒç´ "
   - æ ¹æ®å…·ä½“éœ€æ±‚è°ƒæ•´é˜ˆå€¼
   - æ³¨æ„åƒç´ æ•°é‡çš„åˆç†æ€§

3. **ç»“æžœè§£è¯»**
   - å…³æ³¨ç›¸å…³ç³»æ•°çš„å¤§å°å’Œæ–¹å‘
   - æ£€æŸ¥på€¼çš„ç»Ÿè®¡æ˜¾è‘—æ€§
   - ç»“åˆæ•£ç‚¹å›¾è§‚å¯Ÿæ•°æ®åˆ†å¸ƒ

4. **è‡ªå®šä¹‰è®¾ç½®**
   - ä½¿ç”¨æœ‰æ„ä¹‰çš„æ ‡é¢˜å’Œæ ‡ç­¾
   - é€‰æ‹©åˆé€‚çš„è¾“å‡ºæ–‡ä»¶å‰ç¼€
   - ä¿æŒå‘½åçš„ä¸€è‡´æ€§

## ðŸš¨ æ³¨æ„äº‹é¡¹

1. **æ•°æ®è´¨é‡**
   - ç¡®ä¿å›¾åƒè´¨é‡è‰¯å¥½
   - é¿å…è¿‡å¤šçš„å™ªå£°å’Œä¼ªå½±
   - æ£€æŸ¥å›¾åƒçš„åŠ¨æ€èŒƒå›´

2. **ç»Ÿè®¡è¦æ±‚**
   - éœ€è¦è‡³å°‘5ä¸ªæœ‰æ•ˆåƒç´ ç‚¹
   - æ•°æ®åº”æœ‰è¶³å¤Ÿçš„å˜å¼‚æ€§
   - é¿å…å¸¸æ•°å€¼åŒºåŸŸ

3. **ç»“æžœéªŒè¯**
   - æ£€æŸ¥æ•£ç‚¹å›¾çš„æ•°æ®åˆ†å¸ƒ
   - éªŒè¯ç›¸å…³ç³»æ•°çš„åˆç†æ€§
   - è€ƒè™‘ç”Ÿç‰©å­¦æˆ–ç‰©ç†å­¦æ„ä¹‰

## ðŸ“ž æŠ€æœ¯æ”¯æŒ

å¦‚é‡åˆ°é—®é¢˜ï¼Œè¯·æ£€æŸ¥ï¼š
1. æ–‡ä»¶è·¯å¾„æ˜¯å¦æ­£ç¡®
2. å›¾åƒæ ¼å¼æ˜¯å¦æ”¯æŒ
3. è¾“å‡ºç›®å½•æ˜¯å¦æœ‰å†™å…¥æƒé™
4. æ—¥å¿—ä¿¡æ¯ä¸­çš„é”™è¯¯æç¤º

æ›´å¤šæŠ€æœ¯ç»†èŠ‚è¯·å‚è€ƒæºä»£ç æ³¨é‡Šå’Œæ—¥å¿—è¾“å‡ºã€‚
